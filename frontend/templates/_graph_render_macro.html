{% import "_macros.html" as m %}

{% macro render(graph, showButton=True) -%}
<div class="card mb-4 {% if graph.data is none %}bg-warning{% endif %}" id="graph-{{graph.id}}">

  <div class="text-center">
    <h2 class="graph-header"><a class="js-scroll-trigger" href="#graph-{{graph.id}}">{{ graph.get_name() }}</a></h2>
  </div>

  {% if graph.data is not none %}
  <embed type="image/svg+xml" src= {{ graph.data.render_data_uri()|safe }} />
  <div class="card-body mt-0 pt-0">
    {% if graph.pack.user == user() %}
      <div class="graph-button"><a data-sharer="facebook" data-hashtag="SocialInsight" data-url="{{ url_for('main.graphs', id=graph.id) }}">Share</a></div>
      <div class="graph-button"><a onclick="copyToClipboard({{graph.id}})">Copy link</a></div>
      {% if showButton %}
        <div class="graph-button"><a href="{{ url_for('main.graphs', id=graph.id) }}">Show</a></div>
      {% endif %}
      <div class="graph-button"><a data-toggle="collapse" href="#graph-{{graph.id}}-collapse">Add</a></div>
      <div class="graph-button {{ '' if graph.public else 'disable' }}" id="graph-{{graph.id}}-public"><a onclick="toggleGraphPublic({{graph.id}})">Public</a></div>
      <div class="collapse" id="graph-{{graph.id}}-collapse">
        {% for col in user().collations %}
        <div class="graph-button {{ '' if col.contains(graph) else 'disable' }}" id="graph-{{graph.id}}-{{col.id}}"><a onclick="toggleCollation({{graph.id}}, {{col.id}})">{{ col.name }}</a></div>
        {% endfor %}
      </div>
    {% endif %}
  </div>

  {% else %}
  <div class="card-body mt-0 pt-0 text-center">
    <img class="mt-3" style="height: 200px" src="{{ m.static('images/graph_error.png') }}"/>
    <p class="mt-3">Sorry, error occured</p>
  </div>
  {% endif %}

  <input class="d-none" type="text" value="{{ url_for('main.graphs', id=graph.id, _external=True) }}" id="graph-{{graph.id}}-url">

</div>
{% endmacro -%}
